# Инвест-робот для Тинькофф-инвестиций

Ссылка на задание: [тык](https://github.com/Tinkoff/invest-robot-contest)


## Общее описание

Проект состоит из двух бинарников: генератора конфигов `generate-config` и торгового робота `run-robot`.


### Генератор конфигов для торгового робота
Позволяет сделать yaml-конфиг для торгового робота.
Позволяет указать аккаунт, инструмент (акцию, валюту или фьючерс),
выбрать торговую стратегию и детально настроить эту торговую стратегию.

Торговый конфиг для каждой акции сохраняется в отдельный файл, и простым удалением файла-конфига или его добавлением,
можно конфигурировать торгового робота. 


### Торговый робот
Робот при старте читает директорию с конфигами и создаёт по самостоятельной горутине (микро-роботе) для каждого конфига.
Микро-роботы автономны и автоматически перезапускаются в случае ошибки или завершении работы алгоритма.

Микро-роботы работают параллельно, и каждый робот обслуживает свою ценную бумагу по определённой стратегии.


## SDK
Был написан собственный SDK, который оборачивает gRPC-вызовы, позволяя не думать о протоколе.

В SDK реслизована механика producer-consumer,
где потребители могут подписаться на цену инструмента (консьюмер будет оповещён о каджой новой цене инструмента).
Когда консьюмер заканчивает работу, он отписывается от оповещений.

Это решение было реализовано из-за ограничений на количество запросов,
ведь обмениваться сообщениями через двунаправленный стрим намного оптимальный,
чем отправлять кучу одиночных запросов.


## Автоматизация рутинных операций


### CI
В проекте написан CI, который автоматически запускает линтер и тесты при пулл-реквесте,
таким образам соблюдается чистота кода и его корректность.

Также есть специальный флоу, чтобы собрать релиз. (скоро добавится)


### Makefile
Все рутинные операции автоматизированы при помощи `Makefile`.
По команде `make` будет выведен список доступных автоматизаций (команд).

Например, запуск тестов:
```shell
make tests
```
Например, запуск линтера:
```shell
make lint
```
Собрать протобафы:
```shell
make compile-proto
```
Собрать бинарники:
```shell
make build
```


## База данных
Также была добавлена база данных. Чтобы вести учет того, какие акции были куплены.
Когда микро-робот умирает, он, после перезапуска, ходит в базу данных и восстанавливает своё состояние.


## Запуск проекта
Чтобы запустить проект локально, нужно всего лишь установить `Go` и `protoc`.
После этого выполнить ряд команд:
```shell
make setup
```
А потом собрать бинарники:
```shell
make build
```


## Видео демонстрации работы
- [Генератор конфигов](#)
- [Торговый робот](#)
